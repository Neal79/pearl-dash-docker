# Pearl Dashboard Log Rotation Configuration
# Place this file in /etc/logrotate.d/pearl-dash (remove the .conf extension)

# Laravel application logs
/var/www/html/pearl-dash/storage/logs/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 664 www-data www-data
    sharedscripts
    postrotate
        # Optional: reload PHP-FPM if using it
        # systemctl reload php8.2-fpm
    endscript
}

# Media proxy logs
/var/www/html/pearl-dash/media-proxy/logs/*.log {
    size 50M
    missingok
    rotate 14
    compress
    delaycompress
    notifempty
    create 644 neal neal
    sharedscripts
    postrotate
        # Optional: send HUP signal to media-proxy service if running as systemd service
        # systemctl reload pearl-media-proxy || true
    endscript
}

# Nginx logs for Pearl Dashboard (if using separate vhost)
/var/log/nginx/pearl-dash*.log {
    daily
    missingok
    rotate 52
    compress
    delaycompress
    notifempty
    create 644 www-data adm
    sharedscripts
    prerotate
        if [ -d /etc/logrotate.d/httpd-prerotate ]; then \
            run-parts /etc/logrotate.d/httpd-prerotate; \
        fi
    endscript
    postrotate
        systemctl reload nginx
    endscript
}